
[3.2程序的设计 7](#程序的设计)

[3.2.1程序功能描述与设计思路 7](#程序功能描述与设计思路)

[3.2.2程序流程图 7](#程序流程图)

3.2程序的设计
-------------

### 程序功能描述与设计思路

（1）系统总体工作流程

软件部分主要分成用户交互设计以及数据处理算法设计，基于RT-Thread实时操作系统，利用系统的线程调度完成各个模块的程序处理，程序流程图如图3-3所示。

（2）程序设计思路

在整体软件中，首先在触摸屏菜单进行人机交互，进入不同的功能调用不同的控制函数与数据处理算法。程序线程调度，主要分为简单任务以及核心算法算法任务。简单任务为IO设备、触摸屏、OLED屏幕、语音模块、NB-IOT模块等设备控制；核心控制算法任务为FDC2214电容模拟值采集、卡尔曼滤波以及模糊求解最大可能性落点区间，从而得到当前纸张数量。

### 3.2.2程序流程图

![](../media/9f95c192bfd92310ecad47e2f9367f9c.jpg)

**图3-3 程序流程图**


附录2：源程序
=============

核心函数：计算最大可能落点，返回纸张页数

![](../media/b97e4cd167f12a0e473be5188de05c7a.jpg)
